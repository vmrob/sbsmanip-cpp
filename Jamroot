lib pugixml : [ glob deps/pugixml/src/*.cpp ] :
	<link>static
	<toolset>darwin:<cxxflags>"-std=c++1y -fcolor-diagnostics"
	<runtime-link>static
: :
	<include>deps/pugixml/src
;

cpp-pch pch : src/pch.h :
	<library>pugixml
	<toolset>darwin:<cxxflags>"-std=c++1y -fcolor-diagnostics"
	<toolset>darwin:<define>HAS_MAKE_UNIQUE
: :
	<library>pugixml
	<toolset>darwin:<cxxflags>"-std=c++1y -fcolor-diagnostics"
	<toolset>darwin:<define>HAS_MAKE_UNIQUE
;

lib sbsmanip : [ glob src/*.cpp ] pch :
	<link>static
	<runtime-link>static
:
	<link>static
	<runtime-link>static
:
	<include>include
;

build-project unittests ;

actions convenience-header {
	python generate-convenience-header.py
}

# TODO: use a generation rule instead of the notfile

import notfile ;
notfile sbsmanip-h : @convenience-header ;
explicit sbsmanip-h ;

install sbsmanip-includes : [ glob src/*.h : src/sbsmanip.h-base ] :
	<location>include/sbsmanip
	<dependency>sbsmanip-h
;
install sbsmanip-lib : sbsmanip : <location>lib ;

DEPENDS sbsmanip : sbsmanip-h sbsmanip-includes ;